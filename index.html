<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Procedural Clouds - Fixed Orientation & Speed</title>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <style>html, body { margin: 0; height: 100%; overflow: hidden; }</style>
</head>
<body>
  <script>
    AFRAME.registerShader('procedural-cloud', {
      schema: {
        time: { type: 'time', is: 'uniform' },
        resolution: { type: 'vec2', is: 'uniform', default: { x: 1, y: 1 } }
      },
      glslVersion: '100',
      vertexShader: `
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        }
      `,
      fragmentShader: `
     #ifdef GL_ES
    precision highp float;
    #endif


        uniform float time;
        varying vec2 vUv;

        vec4 textureRND2D(vec2 uv){
          uv = floor(fract(uv)*1e3);
          float v = uv.x + uv.y * 1e3;
          return fract(1e5 * sin(vec4(v*1e-2, (v+1.)*1e-2, (v+1e3)*1e-2, (v+1e3+1.)*1e-2)));
        }

        float noise(vec2 p) {
          vec2 f = fract(p * 1e3);
          vec4 r = textureRND2D(p);
          f = f * f * (3.0 - 2.0 * f);
          return mix(mix(r.x, r.y, f.x), mix(r.z, r.w, f.x), f.y);
        }

        float cloud(vec2 p) {
          float v = 0.0;
          v += noise(p * 1.0) * 0.5;
          v += noise(p * 2.0) * 0.2;
          v += noise(p * 4.0) * 0.125;
          v += noise(p * 8.0) * 0.0625;
          v += noise(p * 16.0) * 0.03125;
          return v * v * v;
        }

        void main() {
          vec2 uv = vUv;

          vec2 p = uv * 0.05 + 0.5;

          vec3 c = vec3(0.0, 0.0, 0.2);
          c += vec3(0.6, 0.6, 0.8) * cloud(p * 0.3 + time * 0.0000001) * 0.6;
          c.gbr += vec3(0.8, 0.8, 1.0) * cloud(p * 0.2 + time * 0.0000001) * 0.8;
          c.grb += vec3(1.0, 1.0, 1.0) * cloud(p * 0.1 + time * 0.0000001) * 1.0;

          gl_FragColor = vec4(c, 1.0);
        }
      `
    });
  </script>

  <a-scene background="black">
    <a-sky shader="procedural-cloud" rotation="0 90 0"></a-sky>
    <a-entity camera position="0 1.6 0" look-controls wasd-controls></a-entity>
  </a-scene>
</body>
</html>

